<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ModelVault</title>
  <style>
    body { font-family: sans-serif; margin: 2em; }
    .file-list { list-style: none; padding: 0; }
    .file-list li { margin: 0.5em 0; cursor: pointer; }
  </style>
</head>
<body>
  <h1>ModelVault ファイル一覧</h1>
  <ul id="file-list" class="file-list"></ul>
  <button id="back" style="display:none;">戻る</button>

  <script>
    const ACCESS_TOKEN = "sl.u.AF_pLbAtrac7KWN5wZRIp-TBX3odei7-pdL4StN0N2hW6saaIFWISMF74nh2QtDwM7Qod7yK_EChs2GM66o_vX9z6Gm-cGcGCZ1zPyjgMIdDnRPzSZ-o91TDpe8suUYYaNEA2NGo5jPLbABUUQNaeqbDV83Ey4scvyaDKiU8r2cigDF0lCwfIWjHSam4MYA3gDhE9UwCXFeApRUOqBCQrgNbVivvU4Rwb2XGAkC6cG5zugp_kWdvTnUCdCNGl8d2_amxdaBSKM88AZdj383FhqZMyn3ONgUUt4w8Mbu0fp12N-1llRJdELittLJCEtFZAkaCHkkJzM4JoLXie_SjGFWIOAxMeuiXAF92MtTAaCa3-IaLqf9rS4JfN1F4Eah_AuOtmMxrZT9w0OSiIMeh7-9FEviCEXkIfDFP9l6TddC90SrnHEbiZEKY1_Z-4B0b65sZz53CtxliAVO4eBrch8j-jqUKJYJQ7SWgPYxsnnzkxWt4TCRFY_maLljgx1KLpP70ah00Pl95r9zUEFFQu264KOLiDi268d1KzF8fkI0dNN5AzEYgh4aNlKd5LAu80MgIdbyvSZ3KuBKEugXIZ2vC__PayCtrh7tLF0izaN8EQ9ZPLw_V18LnuRdlJdHgpE2DsaUHnyLJc-Dc4IhYO2j31FC2gO9i9g-91JDZc0ngFuSZqhLlYNdnrSamcCg-MbWt-1llZtI9NVKHBtWqXx3oxyw5d7fawfOaguxSuim8QrjlYHA8LeYhyPNoybbFC-6llbLdExhbguQeCda7Q3zMPMqvbHb1ozwq4MsJ62lNZMo7sUlqO4QwgdwKIzzZzP_hDCkPh9F8pKmNfP6vKYt71m-e_dw4K2UPeZNiyG75Q0z8-pdPlulEuDZweWeu6LmbsUhW3IayJmzlTwquo54KNUx7Ox46eeSPGZ82Y5j3njelmBgBA2cC3U4yBl-ZqDp13hyYoFc0gZaWrEtL8QNGlCwsFeQr4PC81yw8fAuariEuQCVHnJIIeXLQTduJ1RMAfCFH5XKxvzUiIUh0xucQqkNBC2gRNC1cKE_s6H5M5uvnDaF0Ru1uO93NeMWai_b1bib-5RglZFzDIaePnip4opba5hiIQUqQ6cvl5kkNPJFivVHjDx4w6faPalQ-S2WepRZgjekJ0yY-Dg3_JinvIrfnaHjt9iEkIzu_rqbmu21yJ1uOHNPR4woTfQOQpB3GOiqURDzLTs3k-V_O38h5IQ1QJlHMu1DsZigfZTQUJrygDjCeLj-3Izioa_0iLvvlcSQHFhE4i9RxLTCi6rQZ";

    let currentPath = "";

    async function fetchFiles(path) {
      const response = await fetch(DROPBOX_API, {
        method: "POST",
        headers: {
          "Authorization": "Bearer " + ACCESS_TOKEN,
          "Content-Type": "application/json"
        },
        body: JSON.stringify({ path: path })
      });

      const data = await response.json();
      console.log(data);

      const list = document.getElementById("file-list");
      list.innerHTML = "";

      const backBtn = document.getElementById("back");
      backBtn.style.display = path ? "inline" : "none";
      backBtn.onclick = () => {
        fetchFiles("");
        currentPath = "";
      }

      data.entries.forEach(entry => {
        const li = document.createElement("li");
        li.textContent = entry.name;

        if (entry[".tag"] === "folder") {
          li.onclick = () => {
            currentPath = entry.path_lower;
            fetchFiles(entry.path_lower);
          }
        }

        // ファイルも名前だけ表示
        list.appendChild(li);
      });
    }

    fetchFiles("");
  </script>
</body>
</html>
