<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ModelVault</title>
  <style>
    body { font-family: sans-serif; margin: 2em; }
    .file-list { list-style: none; padding: 0; }
    .file-list li { margin: 0.5em 0; cursor: pointer; }
  </style>
</head>
<body>
  <h1>ModelVault ファイル一覧</h1>
  <ul id="file-list" class="file-list"></ul>
  <button id="back" style="display:none;">戻る</button>

  <script>
    const ACCESS_TOKEN = "sl.u.AF_TK_aSKA7xcF6TL1bUY5Ql9UEwy_jrFgl6dennXuj9uzxs1dSXGsSJhoVWN2RZpXFft11vsyZ09ZdzDTznd4FK1BFGYz6lr2oX8mqugvO5qx24a_Vg7rBsDuIKXtX4gDtFnqLVTNN6mUQHVxLvty3mnRJwpPN9uAhHJG9lP5rOAsmDU8E-jslOYexxqzQk8fvwdA8mkYvW0oUrfy1iXnCWthZu2boG1H-Aaz0cAFTFovBn_Pxvo_1L7-_SZLy92BG1aZV4BxvIGk1cAL1YEIEokUd1SHFAkJN2BJJTqUrwdjcfJjCXo5_xo2qMYoBhdK7FsLapekg6mtEzLaoR7s_Z0bIFv7io1KRnyeqhgaf9h39qa3ArmRNQ3YNKkygkWpdlR7hACcBUS72EslSpl75AqScwW9oJw40dtdyn5q4O0xrzEKmlqmM9blzRHYtfVKN8LUpAJpNNbfiBkVzeSp8Ll8uz67DiHIavmuDARQZWer_0kqnAkk5PPNV1oFOkyEpABUWqiDVephO5P5jYwjWn_7KxDCNS6oTH4_GIqbor6e2EryplQtcBsrqPTj47QVkkQJJMCX9U4xwwihWU6f3E0zxC91ijQD_DP0scWAhG7qVAGeAMh5-qOU64tMqC9Niu0uBqmrUXQXlpjpfpIref2q7G80Fd9F5cCuxQ7NDWQkUbwVHycg7YhWJcfuPfCbnybf5ZZCkulsRqwXKGP86R8JHmn1A6uESvrH8KPvcxbia7fon7HH28PEojs5jtKzUR6EM3Yg1HYQfqh1hU0mDcvBEaoipW7MVvXpGDn36AYhhtHh8AT-AfIH6IBaa6WHSIZRunFD3gJ7m4zzYKoiNnui8yuKAqOZkF5KXuHN9R-yFGYj2jyt0uL9iq6mVURv-eDA4uiZo9B3--zoC9mnYQmCcEh6YMSRZhDcLwB1OG3pd2nQGhtUYalcMw6YowDIaLxEzeFZd55w-_I5xBQr_1SwyPaoM24bgw_Jf6hIqx4e5JZmMhu8kI6_BhRLbRDVL5zNLIAabyOjXIJS_U2x3TLQzAGXWrw9fci8szssvYcSGQ4B2AA7Nfdf8XwT0FKbH8ABJW5RoYxJ5bX6iwjGvGxd5OcPg2X2XSILGHVeqX-Qyl71zgehc96O8X8x1OaPso8_8dvRS4XloopnRSFy9slc79pwpNjqyKluAlQWPyftqnjBB-kRbS8XiRgJ5b5XmDsGTYuauTbb72YNqgMThlHEuU4KpoXIICZSpn3KtfR4piLMzBeSIG775WOOQJauBu2YPMpKL9XQPWb4lrF_v_";
    const DROPBOX_API = "https://api.dropboxapi.com/2/files/list_folder";

    let currentPath = "";

    async function fetchFiles(path) {
      const response = await fetch(DROPBOX_API, {
        method: "POST",
        headers: {
          "Authorization": "Bearer " + ACCESS_TOKEN,
          "Content-Type": "application/json"
        },
        body: JSON.stringify({ path: path })
      });

      const data = await response.json();
      console.log(data);

      const list = document.getElementById("file-list");
      list.innerHTML = "";

      const backBtn = document.getElementById("back");
      backBtn.style.display = path ? "inline" : "none";
      backBtn.onclick = () => {
        fetchFiles("");
        currentPath = "";
      }

      data.entries.forEach(entry => {
        const li = document.createElement("li");
        li.textContent = entry.name;

        if (entry[".tag"] === "folder") {
          li.onclick = () => {
            currentPath = entry.path_lower;
            fetchFiles(entry.path_lower);
          }
        }

        // ファイルも名前だけ表示
        list.appendChild(li);
      });
    }

    fetchFiles("");
  </script>
</body>
</html>
