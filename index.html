<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ModelVault</title>
  <style>
    body { font-family: sans-serif; margin: 2em; }
    .file-list { list-style: none; padding: 0; }
    .file-list li { margin: 0.5em 0; cursor: pointer; }
  </style>
</head>
<body>
  <h1>ModelVault ファイル一覧</h1>
  <ul id="file-list" class="file-list"></ul>
  <button id="back" style="display:none;">戻る</button>

  <script>
    const ACCESS_TOKEN = "sl.u.AF_gkXRZT0E-bqFuBQSSt6SdCpW6bBagzH_iH1jAIHNzKSiNS4CQzmmJHhWHM-kanMEIwtsNk2hscY0hXZACagldTf37SyIyVmOAoc487v9R9X4ukP3FC1BQhbkQdjfe0O7eXuuN27yIIgD3EziZMJrNxDWvKwVrUXd-EYvNuQLYmXHRoIJ7RknkTXo4kRs2-FhiT-xwO8_DEGvIwC1ulilGmUGaLbgXJl9PthFRgq7L-oVc6vEu3EGobmquywx1Lj3lHhP52IXU8Mp3WCGTtHAwnPzIvw8HS-96FylVGWkRFDiNFQlxcxBbuE-eiCuDC7-QncYUpVEWdzZsw64NfS-hmdDwU-KEreYY4h61-vHsTAXVklKPB4cjTAxkk7Gh-iiKDNY1JBQFDayV-ME9rGl_3llyxs4g2pw2MjxcJLKEiEsmY5o2sB5Mh4HbV5xc8KyN_ryQ23UwqrSe2yNzYe9FO5pmOnJ4ciiTBm8y76Kuvd6NptQHt2p4Wo7KceXNvZJR_gqXvwEK1CJ3N08P001qLB7nlY-NAJwnl1qY-jiGCCmVAxxHWwyxStPLxfL0oejRPdnhbstjaI1lWNQm45y6W52FH-RkEm1icOOWmyISRgW3V6LsnNRt3OJ2bJX36Rv2n5tg-cByGGFZ2m0zu3gLzRSK5dB8PZWt81kq5yGYXNJOo_O1LuquXDnWUbd0IDXvts8wSpyDRPPf6ST5SkSWnQANxh9fPRzGXCGF1t05MUZMmoYwrxslZCNI_g7I1UDJjpdaOlFP9bo_HKguVKMZ5hjJgUKszUjg_hjup3oWAvdbC4C4Enje35kqg7xa9uKPuLJC3xVC5UouWjAjStm3eaEPaXSSyFm0gmdZYcTNQU4YFFYAN7C53pB9EBJP9DAofRNkecbYEdorm3Rnd4NIrHfGV0XgG0IY1_gsjoNFhUboO4l-kTAfCPC2XagqcwUpjyvU-iiffcjrj_oJkLCm68ZmkZgRARATkxVHUhPO0zoQ9QY4Xrff4j2Xi62-d36jJzDFWRjRgMksFbwohovvTlGAZ33KzFF2SHIpeV37n7X73EhVQwZLYR9igAZdhptsnf0obSRPFPIAgCJnI1A2DZY55JTSVD_-spyMAj7y6wDQmcBzZQVaQjEfd7VRlUpSvL259RDyFfag4VBgNsowPVIyyOBr3teZhX8t5N1I__GYNBIqNTDnqG4Rlpq0GCRCm1VFwlh4nXbn0s-Yj4C50qRelkhFvYZ_6yBBD7TIhu5qMW9yb9x64QSVm6x0Z2E";

    let currentPath = "";

    async function fetchFiles(path) {
      const response = await fetch(DROPBOX_API, {
        method: "POST",
        headers: {
          "Authorization": "Bearer " + ACCESS_TOKEN,
          "Content-Type": "application/json"
        },
        body: JSON.stringify({ path: path })
      });

      const data = await response.json();
      console.log(data);

      const list = document.getElementById("file-list");
      list.innerHTML = "";

      const backBtn = document.getElementById("back");
      backBtn.style.display = path ? "inline" : "none";
      backBtn.onclick = () => {
        fetchFiles("");
        currentPath = "";
      }

      data.entries.forEach(entry => {
        const li = document.createElement("li");
        li.textContent = entry.name;

        if (entry[".tag"] === "folder") {
          li.onclick = () => {
            currentPath = entry.path_lower;
            fetchFiles(entry.path_lower);
          }
        }

        // ファイルも名前だけ表示
        list.appendChild(li);
      });
    }

    fetchFiles("");
  </script>
</body>
</html>
